<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Android音频开发（五）——使用ffmpeg播放音频 | 又尔enter的blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Android,音视频,NDK,ffmpeg">
    <meta name="description" content="上一节，我们做了很多准备工作，把ffmpeg源码编译成so供我们使用，这下我们终于可以来真正的使用它了。请大家使用最新版本你的AS，使用cmake，抛弃以前的mk。 首先，创建一个新的project，记得勾上Include C++ support，然后一路next就ok了。我们发现main下面多了一个cpp文件夹，这就是你放c/c++源代码的地方，为了用到我们的ffmpeg so文件，我们在mai">
<meta name="keywords" content="Android,音视频,NDK,ffmpeg">
<meta property="og:type" content="article">
<meta property="og:title" content="Android音频开发（五）——使用ffmpeg播放音频">
<meta property="og:url" content="http://yoursite.com/2018/04/15/audio5/index.html">
<meta property="og:site_name" content="又尔enter的blog">
<meta property="og:description" content="上一节，我们做了很多准备工作，把ffmpeg源码编译成so供我们使用，这下我们终于可以来真正的使用它了。请大家使用最新版本你的AS，使用cmake，抛弃以前的mk。 首先，创建一个新的project，记得勾上Include C++ support，然后一路next就ok了。我们发现main下面多了一个cpp文件夹，这就是你放c/c++源代码的地方，为了用到我们的ffmpeg so文件，我们在mai">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/3287039-b3d339e13cae94ce.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/3287039-465e48a05eb76058.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-04-15T06:32:01.223Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android音频开发（五）——使用ffmpeg播放音频">
<meta name="twitter:description" content="上一节，我们做了很多准备工作，把ffmpeg源码编译成so供我们使用，这下我们终于可以来真正的使用它了。请大家使用最新版本你的AS，使用cmake，抛弃以前的mk。 首先，创建一个新的project，记得勾上Include C++ support，然后一路next就ok了。我们发现main下面多了一个cpp文件夹，这就是你放c/c++源代码的地方，为了用到我们的ffmpeg so文件，我们在mai">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/3287039-b3d339e13cae94ce.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    
        <link rel="alternate" type="application/atom+xml" title="又尔enter的blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">又尔enter</h5>
          <a href="mailto:253943128@qq.com" title="253943128@qq.com" class="mail">253943128@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/dengyuaner" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://weibo.com/u/6017479561" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                微博
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/custom"  >
                <i class="icon icon-lg icon-link"></i>
                测试
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Android音频开发（五）——使用ffmpeg播放音频</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Android音频开发（五）——使用ffmpeg播放音频</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-04-15T06:28:44.000Z" itemprop="datePublished" class="page-time">
  2018-04-15
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Android/">Android</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Android/NDK/">NDK</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Android/NDK/ffmpeg/">ffmpeg</a></li></ul></li></ul></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>目录</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#首先，创建一个新的project，记得勾上Include-C-support，然后一路next就ok了。"><span class="post-toc-number">1.</span> <span class="post-toc-text">首先，创建一个新的project，记得勾上Include C++ support，然后一路next就ok了。</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#然后在cpp目录下创建play-audio-cpp"><span class="post-toc-number">2.</span> <span class="post-toc-text">然后在cpp目录下创建play_audio.cpp</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#下面贴出关键代码"><span class="post-toc-number">3.</span> <span class="post-toc-text">下面贴出关键代码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#然后是activity"><span class="post-toc-number">4.</span> <span class="post-toc-text">然后是activity</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#接下来就是最重要的编写cmake"><span class="post-toc-number">5.</span> <span class="post-toc-text">接下来就是最重要的编写cmake</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#然后编译执行，done，完整demo请移步我的github"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">然后编译执行，done，完整demo请移步我的github</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-audio5"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Android音频开发（五）——使用ffmpeg播放音频</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-04-15 14:28:44" datetime="2018-04-15T06:28:44.000Z"  itemprop="datePublished">2018-04-15</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Android/">Android</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Android/NDK/">NDK</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Android/NDK/ffmpeg/">ffmpeg</a></li></ul></li></ul></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>上一节，我们做了很多准备工作，把ffmpeg源码编译成so供我们使用，这下我们终于可以来真正的使用它了。请大家使用最新版本你的AS，使用cmake，抛弃以前的mk。</p>
<h2 id="首先，创建一个新的project，记得勾上Include-C-support，然后一路next就ok了。"><a href="#首先，创建一个新的project，记得勾上Include-C-support，然后一路next就ok了。" class="headerlink" title="首先，创建一个新的project，记得勾上Include C++ support，然后一路next就ok了。"></a>首先，创建一个新的project，记得勾上Include C++ support，然后一路next就ok了。</h2><p>我们发现main下面多了一个cpp文件夹，这就是你放c/c++源代码的地方，为了用到我们的ffmpeg so文件，我们在main下面创建jniLibs,把编好的lib里面的so放进去。<br>PS：之前我们编译的平台是armeabi，如果你想要x86可修改脚本文件中相关配置</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://upload-images.jianshu.io/upload_images/3287039-b3d339e13cae94ce.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="111.jpg" title="">
                </div>
                <div class="image-caption">111.jpg</div>
            </figure>
<p>其中main，sdl不是ffmpeg编译的so，大家不必在意。然后把include放进cpp文件夹，这些是需要的头文件，</p>
<h2 id="然后在cpp目录下创建play-audio-cpp"><a href="#然后在cpp目录下创建play-audio-cpp" class="headerlink" title="然后在cpp目录下创建play_audio.cpp"></a>然后在cpp目录下创建play_audio.cpp</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://upload-images.jianshu.io/upload_images/3287039-465e48a05eb76058.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="a3.png" title="">
                </div>
                <div class="image-caption">a3.png</div>
            </figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#include &lt;jni.h&gt;</span><br><span class="line">#include &quot;log.h&quot;</span><br><span class="line"></span><br><span class="line">extern &quot;C&quot; &#123;</span><br><span class="line">#include &quot;AudioDevice.h&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//注意加extern &quot;C&quot;，否则将按照C++的编译方法吧方法名改了，则java层找不到相应的方法</span><br><span class="line">extern &quot;C&quot;</span><br><span class="line">JNIEXPORT jint JNICALL</span><br><span class="line">Java_com_dy_ffmpeg_PlayMusicActivity_play(JNIEnv *env, jobject instance, jstring url_) &#123;</span><br><span class="line">    const char *url = env-&gt;GetStringUTFChars(url_, 0);</span><br><span class="line"></span><br><span class="line">    LOGD(&quot;play&quot;);</span><br><span class="line">    int code = play(url);</span><br><span class="line">    return code;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extern &quot;C&quot;</span><br><span class="line">JNIEXPORT jint JNICALL</span><br><span class="line">Java_com_dy_ffmpeg_PlayMusicActivity_stop(JNIEnv *env, jobject instance) &#123;</span><br><span class="line"></span><br><span class="line">    // TODO</span><br><span class="line">    LOGD(&quot;stop&quot;);</span><br><span class="line">    int code = shutdown();</span><br><span class="line">    return code;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="下面贴出关键代码"><a href="#下面贴出关键代码" class="headerlink" title="下面贴出关键代码"></a>下面贴出关键代码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 初始化操作，创建解码器</span><br><span class="line"> * @param file_name  文件名</span><br><span class="line"> * @param rate 采样率</span><br><span class="line"> * @param channel 通道数</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">int init(const char *file_name, int *rate, int *channel) &#123;</span><br><span class="line"></span><br><span class="line">    //初始化</span><br><span class="line">    av_register_all();</span><br><span class="line">    aFormatCtx = avformat_alloc_context();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    //读取输入的音频文件地址</span><br><span class="line">    if (avformat_open_input(&amp;aFormatCtx, file_name, NULL, NULL) != 0) &#123;</span><br><span class="line">        LOGE(&quot;文件%s不存在！\n&quot;, file_name);</span><br><span class="line">        return -1; // Couldn&apos;t open file</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //查找文件的流信息</span><br><span class="line">    if (avformat_find_stream_info(aFormatCtx, NULL) &lt; 0) &#123;</span><br><span class="line">        LOGE(&quot;文件流信息错误\n&quot;);</span><br><span class="line">        return -1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //找到第一个音频帧</span><br><span class="line">    int i;</span><br><span class="line">    audioStream = -1;</span><br><span class="line">    for (i = 0; i &lt; aFormatCtx-&gt;nb_streams; i++) &#123;</span><br><span class="line">        if (aFormatCtx-&gt;streams[i]-&gt;codec-&gt;codec_type == AVMEDIA_TYPE_AUDIO) &#123;</span><br><span class="line">            audioStream = i;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (audioStream == -1) &#123;</span><br><span class="line">        LOGE(&quot;音频流未找到!&quot;);</span><br><span class="line">        return -1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    aCodecCtx = aFormatCtx-&gt;streams[audioStream]-&gt;codec;</span><br><span class="line"></span><br><span class="line">    //获取相应音频流的解码器</span><br><span class="line">    AVCodec *aCodec = avcodec_find_decoder(aCodecCtx-&gt;codec_id);</span><br><span class="line">    if (!aCodec) &#123;</span><br><span class="line">        fprintf(stderr, &quot;不支持的音频格式!\n&quot;);</span><br><span class="line">        return -1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (avcodec_open2(aCodecCtx, aCodec, NULL) &lt; 0) &#123;</span><br><span class="line">        LOGE(&quot;无法打开解码器！\n&quot;);</span><br><span class="line">        return -1; // Could not open codec</span><br><span class="line">    &#125;</span><br><span class="line">    //分配一个帧指针，指向解码后的原始帧</span><br><span class="line">    aFrame = av_frame_alloc();</span><br><span class="line"></span><br><span class="line">    // 设置格式转换</span><br><span class="line">    swr = swr_alloc();</span><br><span class="line">    //输入通道数</span><br><span class="line">    av_opt_set_int(swr, &quot;in_channel_layout&quot;, aCodecCtx-&gt;channel_layout, 0);</span><br><span class="line">    //输出通道数</span><br><span class="line">    av_opt_set_int(swr, &quot;out_channel_layout&quot;, aCodecCtx-&gt;channel_layout, 0);</span><br><span class="line">    //输入采样率</span><br><span class="line">    av_opt_set_int(swr, &quot;in_sample_rate&quot;, aCodecCtx-&gt;sample_rate, 0);</span><br><span class="line">    //输出采样率</span><br><span class="line">    av_opt_set_int(swr, &quot;out_sample_rate&quot;, aCodecCtx-&gt;sample_rate, 0);</span><br><span class="line">    //输入采样位宽</span><br><span class="line">    av_opt_set_sample_fmt(swr, &quot;in_sample_fmt&quot;, aCodecCtx-&gt;sample_fmt, 0);</span><br><span class="line">    //输出采样位宽，16bit</span><br><span class="line">    av_opt_set_sample_fmt(swr, &quot;out_sample_fmt&quot;, AV_SAMPLE_FMT_S16, 0);</span><br><span class="line">    swr_init(swr);</span><br><span class="line"></span><br><span class="line">    // 分配PCM数据缓冲区大小</span><br><span class="line">    outputBufferSize = 8196;</span><br><span class="line">    outputBuffer = (uint8_t *) malloc(sizeof(uint8_t) * outputBufferSize);</span><br><span class="line"></span><br><span class="line">    // 返回采样率和通道数</span><br><span class="line">    *rate = aCodecCtx-&gt;sample_rate;</span><br><span class="line">    *channel = aCodecCtx-&gt;channels;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">// 获取PCM数据, 自动回调获取</span><br><span class="line">int getPCM(void **pcm, size_t *pcmSize) &#123;</span><br><span class="line">    LOGD(&quot;getPcm&quot;);</span><br><span class="line">    while (av_read_frame(aFormatCtx, &amp;packet) &gt;= 0) &#123;</span><br><span class="line"></span><br><span class="line">        int frameFinished = 0;</span><br><span class="line">        // Is this a packet from the audio stream?</span><br><span class="line">        if (packet.stream_index == audioStream) &#123;</span><br><span class="line">            avcodec_decode_audio4(aCodecCtx, aFrame, &amp;frameFinished, &amp;packet);</span><br><span class="line"></span><br><span class="line">            if (frameFinished) &#123;</span><br><span class="line">                // data_size为音频数据所占的字节数</span><br><span class="line">                int data_size = av_samples_get_buffer_size(</span><br><span class="line">                        aFrame-&gt;linesize, aCodecCtx-&gt;channels,</span><br><span class="line">                        aFrame-&gt;nb_samples, aCodecCtx-&gt;sample_fmt, 1);</span><br><span class="line"></span><br><span class="line">                // 这里内存再分配可能存在问题</span><br><span class="line">                if (data_size &gt; outputBufferSize) &#123;</span><br><span class="line">                    outputBufferSize = data_size;</span><br><span class="line">                    outputBuffer = (uint8_t *) realloc(outputBuffer,</span><br><span class="line">                                                       sizeof(uint8_t) * outputBufferSize);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                // 音频格式转换</span><br><span class="line">                swr_convert(swr, &amp;outputBuffer, aFrame-&gt;nb_samples,</span><br><span class="line">                            (uint8_t const **) (aFrame-&gt;extended_data),</span><br><span class="line">                            aFrame-&gt;nb_samples);</span><br><span class="line"></span><br><span class="line">                // 返回pcm数据</span><br><span class="line">                *pcm = outputBuffer;</span><br><span class="line">                *pcmSize = data_size;</span><br><span class="line">                return 0;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return -1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="然后是activity"><a href="#然后是activity" class="headerlink" title="然后是activity"></a>然后是activity</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">package com.dy.ffmpeg;</span><br><span class="line"></span><br><span class="line">import android.os.Bundle;</span><br><span class="line">import android.os.Environment;</span><br><span class="line">import android.support.v7.app.AppCompatActivity;</span><br><span class="line">import android.view.View;</span><br><span class="line">import android.widget.Button;</span><br><span class="line"></span><br><span class="line">public class PlayMusicActivity extends AppCompatActivity implements View.OnClickListener &#123;</span><br><span class="line">    static &#123;</span><br><span class="line">        System.loadLibrary(&quot;play_audio&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private Button play;</span><br><span class="line">    private Button stop;</span><br><span class="line">    private String url;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_play_music);</span><br><span class="line">        initView();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void initView() &#123;</span><br><span class="line">        play = (Button) findViewById(R.id.play);</span><br><span class="line">        stop = (Button) findViewById(R.id.stop);</span><br><span class="line"></span><br><span class="line">        play.setOnClickListener(this);</span><br><span class="line">        stop.setOnClickListener(this);</span><br><span class="line">        //获取文件地址,注意把音频文件放在该目录下，或者修改成你自己需要的路径</span><br><span class="line">        String folderurl = Environment.getExternalStorageDirectory().getPath();</span><br><span class="line">        url = folderurl + &quot;/Valentine.mp3&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onClick(View v) &#123;</span><br><span class="line">        switch (v.getId()) &#123;</span><br><span class="line">            case R.id.play:</span><br><span class="line">                new Thread(new Runnable() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    public void run() &#123;</span><br><span class="line">                        int code = play(url);</span><br><span class="line">                        System.out.println(&quot;开始播放&quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).start();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                break;</span><br><span class="line">            case R.id.stop:</span><br><span class="line">                new Thread(new Runnable() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    public void run() &#123;</span><br><span class="line">                        int code = stop();</span><br><span class="line">                        if (code == 0) &#123;</span><br><span class="line">                            System.out.println(&quot;停止成功&quot;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).start();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private native int play(String url);</span><br><span class="line"></span><br><span class="line">    private native int stop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="接下来就是最重要的编写cmake"><a href="#接下来就是最重要的编写cmake" class="headerlink" title="接下来就是最重要的编写cmake"></a>接下来就是最重要的编写cmake</h2><p>接下来就是最重要的编写cmake</p>
<p>接下来就是最重要的编写cmake</p>
<p>上面我们做了这么多工作，gradle编译的时候怎么知道去哪找这些东西呢，就是重要的app目录下得CMakeLists.txt文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.4.1)</span><br><span class="line">#设置so目录</span><br><span class="line">set(lib_src_DIR $&#123;CMAKE_SOURCE_DIR&#125;/src/main/jniLibs/$&#123;ANDROID_ABI&#125;)</span><br><span class="line">#添加头文件查找路径，包括引入库的和自己写的</span><br><span class="line">include_directories(</span><br><span class="line">     $&#123;CMAKE_SOURCE_DIR&#125;/src/main/cpp/include</span><br><span class="line">)</span><br><span class="line">#添加动态库或静态库，其中本地的动态库名称,位置可以由set_target_properties设置</span><br><span class="line">add_library(avcodec-57_lib SHARED IMPORTED)</span><br><span class="line">set_target_properties(avcodec-57_lib PROPERTIES IMPORTED_LOCATION</span><br><span class="line">                          $&#123;lib_src_DIR&#125;/libavcodec-57.so)</span><br><span class="line"></span><br><span class="line">add_library(avformat-57_lib SHARED IMPORTED)</span><br><span class="line">set_target_properties(avformat-57_lib PROPERTIES IMPORTED_LOCATION</span><br><span class="line">                     $&#123;lib_src_DIR&#125;/libavformat-57.so)</span><br><span class="line"></span><br><span class="line">add_library(avutil-55_lib SHARED IMPORTED)</span><br><span class="line">set_target_properties(avutil-55_lib PROPERTIES IMPORTED_LOCATION</span><br><span class="line">                     $&#123;lib_src_DIR&#125;/libavutil-55.so)</span><br><span class="line"></span><br><span class="line">add_library(swresample-2_lib SHARED IMPORTED)</span><br><span class="line">set_target_properties(swresample-2_lib PROPERTIES IMPORTED_LOCATION</span><br><span class="line">                     $&#123;lib_src_DIR&#125;/libswresample-2.so)</span><br><span class="line"></span><br><span class="line">add_library(swscale-4_lib SHARED IMPORTED)</span><br><span class="line">set_target_properties(swscale-4_lib PROPERTIES IMPORTED_LOCATION</span><br><span class="line">                     $&#123;lib_src_DIR&#125;/libswscale-4.so)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># build application&apos;s shared lib</span><br><span class="line">#这里是你自己编写的c/c++，因为用到ffmpeg的so，所以下面要链接它的库</span><br><span class="line">add_library(play_video SHARED</span><br><span class="line">         $&#123;CMAKE_SOURCE_DIR&#125;/src/main/cpp/play_video.cpp)</span><br><span class="line">add_library(decode_video SHARED</span><br><span class="line">         $&#123;CMAKE_SOURCE_DIR&#125;/src/main/cpp/decode_video.cpp)</span><br><span class="line">add_library(play_audio SHARED</span><br><span class="line">         $&#123;CMAKE_SOURCE_DIR&#125;/src/main/cpp/play_audio.cpp</span><br><span class="line">         $&#123;CMAKE_SOURCE_DIR&#125;/src/main/cpp/AudioDevice.c</span><br><span class="line">         $&#123;CMAKE_SOURCE_DIR&#125;/src/main/cpp/FFmpegAudioPlay.c)</span><br><span class="line">#通过名称查找并引入库，可以引入 NDK 中的库，比如日志模块</span><br><span class="line">find_library( # Sets the name of the path variable.</span><br><span class="line">              log-lib</span><br><span class="line"></span><br><span class="line">              # Specifies the name of the NDK library that</span><br><span class="line">              # you want CMake to locate.</span><br><span class="line">              log )</span><br><span class="line">#添加参加编译的库名称，也可以是绝对路径，注意被依赖的模块写在后面</span><br><span class="line">#特别注意，你想生成几个so，就要写几个link，写在一个link里面是错误的</span><br><span class="line">target_link_libraries(play_video</span><br><span class="line">log</span><br><span class="line">android</span><br><span class="line">avcodec-57_lib</span><br><span class="line">avformat-57_lib</span><br><span class="line">avutil-55_lib</span><br><span class="line">swresample-2_lib</span><br><span class="line">swscale-4_lib</span><br><span class="line">)</span><br><span class="line">target_link_libraries(decode_video</span><br><span class="line">log</span><br><span class="line">android</span><br><span class="line">avcodec-57_lib</span><br><span class="line">avformat-57_lib</span><br><span class="line">avutil-55_lib</span><br><span class="line">swresample-2_lib</span><br><span class="line">swscale-4_lib</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">#我们需要opensl es来辅助播放，注意加入opensl es</span><br><span class="line">target_link_libraries(play_audio</span><br><span class="line">log</span><br><span class="line">OpenSLES</span><br><span class="line">android</span><br><span class="line">avcodec-57_lib</span><br><span class="line">avformat-57_lib</span><br><span class="line">avutil-55_lib</span><br><span class="line">swresample-2_lib</span><br><span class="line">swscale-4_lib</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h3 id="然后编译执行，done，完整demo请移步我的github"><a href="#然后编译执行，done，完整demo请移步我的github" class="headerlink" title="然后编译执行，done，完整demo请移步我的github"></a>然后编译执行，done，完整demo请移步<a href="https://github.com/dengyuaner/ffmpegDemo" target="_blank" rel="noopener">我的github</a></h3><p>参考<a href="http://blog.csdn.net/leixiaohua1020/article/details/47008825" target="_blank" rel="noopener">http://blog.csdn.net/leixiaohua1020/article/details/47008825</a></p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2018-04-15T06:32:01.223Z" itemprop="dateUpdated">2018-04-15 14:32:01</time>
</span><br>


        
	<br />
	
        又尔enter版权所有，转载请注明出处：<a href="/2018/04/15/audio5/" target="_blank" rel="external">http://yoursite.com/2018/04/15/audio5/index.html</a>
        
    </div>
    
    <footer>
        <a href="http://yoursite.com">
            <img src="/img/avatar.jpg" alt="又尔enter">
            又尔enter
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NDK/">NDK</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ffmpeg/">ffmpeg</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/音视频/">音视频</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2018/04/15/audio5/&title=《Android音频开发（五）——使用ffmpeg播放音频》 — 又尔enter的blog&pic=http://yoursite.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2018/04/15/audio5/&title=《Android音频开发（五）——使用ffmpeg播放音频》 — 又尔enter的blog&source=Android开发小小鸟" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2018/04/15/audio5/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Android音频开发（五）——使用ffmpeg播放音频》 — 又尔enter的blog&url=http://yoursite.com/2018/04/15/audio5/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2018/04/15/audio5/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2018/04/15/handler/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Android线程间通信基础——Handler,Looper,MessageQueue</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2018/04/15/audio4/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Android音频开发（四）——ffmpeg的编译</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'false' == 'true',
            verify: 'false' == 'true',
            appId: "67n8leMw86YpY0SAhDSbP5KS-gzGzoHsz",
            appKey: "ASLkdXiKzhwVfITucqazdCbA",
            avatar: "mm/identicon/monsterid/wavatar/retro",
            placeholder: "请输入您的留言",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->







</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.png" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>又尔enter &copy; 2017 - 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2018/04/15/audio5/&title=《Android音频开发（五）——使用ffmpeg播放音频》 — 又尔enter的blog&pic=http://yoursite.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2018/04/15/audio5/&title=《Android音频开发（五）——使用ffmpeg播放音频》 — 又尔enter的blog&source=Android开发小小鸟" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2018/04/15/audio5/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Android音频开发（五）——使用ffmpeg播放音频》 — 又尔enter的blog&url=http://yoursite.com/2018/04/15/audio5/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2018/04/15/audio5/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAABu0lEQVR42u3ay46DMAwFUP7/p5ntjCrQtU0yVDpZoZaSQxeWHzmOeJ2/1tXnyT2fnx8rFi4u7ph73q7PR19dJ7tcvUBiwMXF3c+tbjBB5K+Ni4v7Xdyzte6fj4uL+43cvOBJQLi4uO/nJulI8u2LajVcXNwBt9fUePZ6SX8XFxe3xT0HK9lyXiz92REXF3cLtxp0qo2PyYT08k/BxcXdyM2h922OauGUlENHcisuLu4Cbl789LbphbACBRcXdwG394hqopOnMlGKg4uL+0/cdYVQdSiLi4u7h5sXOfnxiGrgSxIjXFzcndzVw9d5abR1VoyLi9vasjdqTRor5eIHFxd3Mfc+Wek1SXuxsxB3cXFxl3GfHXgkoa1XFOHi4u7kTg5YVGegvSNcx+TNcHFxW9z8gFQ18OUj1fy3uLi4e7hPBaxypVUsgXBxcXdyz+Kqhrbq+KR5TgQXF/dR7jy4VBOavI0yQuPi4o651SZplXJPLI9hcHFxN3LzgxHljmwrmuLi4n4Lt5qyJAGu3EbBxcV9GbfKqhZIzVErLi7uMm71MNa83dlsqeDi4m7hzvOK3gGsdWNaXFzcAfcHjKqVjCNEh/MAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '看这里看这里!';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)嘿嘿!好看吧!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
